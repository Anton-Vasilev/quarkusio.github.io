<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Unresolved directive in _attributes.adoc - include::_attributes-local.adoc[]</p>
</div>
<div class="paragraph">
<p><a href="https://upx.github.io/">Ultimate Packer for eXecutables (UPX)</a> is a compression tool reducing the size of executables.
Quarkus can compress the produced native executable to reduce its size.
Such compression is interesting when:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>building CLI tools, and you want to reduce the disk footprint,</p>
</li>
<li>
<p>building small container images.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that UPX compression:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>increases your build time, mainly if you use high-compression levels</p>
</li>
<li>
<p>increases the startup RSS usage of the application</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="system-vs-container"><a class="anchor" href="#system-vs-container"></a>System vs. Container</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The UPX compression requires:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <code>upx</code> command to be available in the system <code>PATH</code>;</p>
</li>
<li>
<p>or to have built the native executable using an in-container build.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you have the <code>upx</code> command available on your path, Quarkus uses it.
Otherwise, if you built the native image using an in-container build (using <code>quarkus.native.container-build=true</code>) and if the builder image provides the <code>upx</code> command, Quarkus compresses the executable from inside the container.</p>
</div>
<div class="paragraph">
<p>If you are not in one of these cases, the compression fails.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="title">upx is cross-platform.</div>
<div class="paragraph">
<p><code>upx</code> can compress executables using a different architecture and OS than your host machine. For example, <code>upx</code> on a macOS machine can compress a Linux 64-bits executables.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-the-upx-compression"><a class="anchor" href="#configuring-the-upx-compression"></a>Configuring the UPX compression</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Then, in your application configuration, enable the compression by configuring the <em>compression level</em> you want:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.native.compression.level=5</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the compression level is not set, the compression is disabled.
The compression will happen once the native executable is built and will replace the executable.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="compression-level"><a class="anchor" href="#compression-level"></a>Compression level</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The compression level goes from 1 to 10:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>1</code>: faster compression</p>
</li>
<li>
<p><code>9</code>: better compression</p>
</li>
<li>
<p><code>10</code>: best compression (can be slow for big files)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="extra-parameters"><a class="anchor" href="#extra-parameters"></a>Extra parameters</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can pass extra parameter to upx, such as <code>--brute</code> or <code>--ultra-brute</code> using the <code>quarkus.native.compression.additional-args</code> parameter.
The value is a comma-separated list of arguments:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.native.compression.level=3
quarkus.native.compression.additional-args=--ultra-brute,-v</code></pre>
</div>
</div>
<div class="paragraph">
<p>The exhaustive list of parameters can be found in <a href="https://github.com/upx/upx/blob/devel/doc/upx.pod">the UPX documentation</a>.</p>
</div>
</div>
</div>