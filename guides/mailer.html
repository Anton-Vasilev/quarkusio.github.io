<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This guide demonstrates how your Quarkus application can send emails using an SMTP server.
This is a getting started guide.
Check the <a href="mailer-reference">Quarkus Mailer Reference documentation</a> for more complete explanation about the mailer and its usage.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="prerequisites"><a class="anchor" href="#prerequisites"></a>Prerequisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Unresolved directive in mailer.adoc - include::{includes}/prerequisites.adoc[]
* The SMTP hostname, port and credentials, and an email address
* cURL</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="architecture"><a class="anchor" href="#architecture"></a>Architecture</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this guide, we will build an application:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>exposing an HTTP endpoint,</p>
</li>
<li>
<p>sending email when the endpoint receives an HTTP request.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The application will demonstrate how to send emails using the <em>imperative</em> and <em>reactive</em> mailer APIs.</p>
</div>
<div class="paragraph">
<p>Attachments, inlined attachments, templating, testing and more advanced configuration are covered in the <a href="mailer-reference">Mailer Reference documentation</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="solution"><a class="anchor" href="#solution"></a>Solution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We recommend that you follow the instructions in the next sections and create the application step by step.
However, you can go right to the completed example.</p>
</div>
<div class="paragraph">
<p>Clone the Git repository: <code>git clone <a href="https://github.com/quarkusio/quarkus-quickstarts.git" class="bare">https://github.com/quarkusio/quarkus-quickstarts.git</a></code>, or download an <a href="https://github.com/quarkusio/quarkus-quickstarts/archive/main.zip">archive</a>.</p>
</div>
<div class="paragraph">
<p>The solution is located in the <code>mailer-quickstart</code> <a href="https://github.com/quarkusio/quarkus-quickstarts/tree/main/mailer-quickstart">directory</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-the-maven-project"><a class="anchor" href="#creating-the-maven-project"></a>Creating the Maven Project</h2>
<div class="sectionbody">
<div class="paragraph">
<p>First, we need a project.
Open your browser to <a href="https://code.quarkus.io" class="bare">https://code.quarkus.io</a> and select the following extensions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>RESTEasy Reactive - we use it to expose our HTTP endpoint</p>
</li>
<li>
<p>Mailer - which offer the possibility to send emails</p>
</li>
<li>
<p>Qute - the Quarkus template engine</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Alternatively, this <a href="https://code.quarkus.io/?a=quarkus-mailer-getting-started&amp;nc=true&amp;e=resteasy-reactive&amp;e=qute&amp;e=mailer&amp;extension-search=mail">link</a> pre-configures the application.
Click on "Generate your application", download the zip file and unzip it on your file system.
Open the generated project in your IDE.
In a terminal, navigate to the project and start dev mode:</p>
</div>
<div class="paragraph">
<p>Unresolved directive in mailer.adoc - include::{includes}/devtools/dev.adoc[]</p>
</div>
<div class="sect2">
<h3 id="implement-the-http-endpoint"><a class="anchor" href="#implement-the-http-endpoint"></a>Implement the HTTP endpoint</h3>
<div class="paragraph">
<p>First, create the <code>src/main/java/org/acme/MailResource.java</code> file, with the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme;

import io.quarkus.mailer.Mail;
import io.quarkus.mailer.Mailer;
import io.smallrye.common.annotation.Blocking;

import jakarta.inject.Inject;
import jakarta.ws.rs.GET;
import jakarta.ws.rs.Path;

@Path("/mail")                                                          <i class="conum" data-value="1"></i><b>(1)</b>
public class MailResource {

    @Inject Mailer mailer;                                              <i class="conum" data-value="2"></i><b>(2)</b>

    @GET                                                                <i class="conum" data-value="3"></i><b>(3)</b>
    @Blocking                                                           <i class="conum" data-value="4"></i><b>(4)</b>
    public void sendEmail() {
        mailer.send(
                Mail.withText("quarkus@quarkus.io",                     <i class="conum" data-value="5"></i><b>(5)</b>
                    "Ahoy from Quarkus",
                    "A simple email sent from a Quarkus application."
                )
        );
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Configure the root path of our HTTP endpoint</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Inject the <code>Mailer</code> object managed by Quarkus</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Create a method that will handle the HTTP GET request on <code>/mail</code></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Because we are using RESTEasy Reactive and the <em>imperative</em> mailer, we need to add the <code>@Blocking</code> annotation. We will see later the reactive variant.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Create a <code>Mail</code> object by configuring the <em>to</em> recipient, the subject and body</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>MailResource</code> class implements the HTTP API exposed by our application.
It handles <code>GET</code> request on `http://localhost:8080/mail.</p>
</div>
<div class="paragraph">
<p>So, if in another terminal, you run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; curl http://localhost:8080/mail</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should see in the application log something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">INFO  [quarkus-mailer] (executor-thread-0) Sending email Ahoy from Quarkus from null to [quarkus@quarkus.io], text body:
A simple email sent from a Quarkus application.
html body:
&lt;empty&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>As the application runs in <em>dev mode</em>, it simulates the sending of the emails.
It prints it in the log, so you can check that what was about to be sent.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This section used the <em>imperative</em> mailer API.
It blocks the caller thread until the mail is sent.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-the-reactive-mailer"><a class="anchor" href="#using-the-reactive-mailer"></a>Using the reactive mailer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The last section use the <em>imperative</em> mailer.
Quarkus also offers a reactive API.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Mutiny</div>
<div class="paragraph">
<p>The reactive mailer uses Mutiny reactive types.
If you are not familiar with Mutiny, check <a href="mutiny-primer">Mutiny - an intuitive reactive programming library</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the same class, add:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
ReactiveMailer reactiveMailer;                          <i class="conum" data-value="1"></i><b>(1)</b>

@GET
@Path("/reactive")                                      <i class="conum" data-value="2"></i><b>(2)</b>
public Uni&lt;Void&gt; sendEmailUsingReactiveMailer() {       <i class="conum" data-value="3"></i><b>(3)</b>
    return reactiveMailer.send(                         <i class="conum" data-value="4"></i><b>(4)</b>
                Mail.withText("quarkus@quarkus.io",
                    "Ahoy from Quarkus",
                    "A simple email sent from a Quarkus application using the reactive API."
                )
        );
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Inject the reactive mailer. The class to import is <code>io.quarkus.mailer.reactive.ReactiveMailer</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Configure the path to handle GET request on <code>/mail/reactive</code>. Note that because we are using the reactive API, we don&#8217;t need <code>@Blocking</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The method returns a <code>Uni&lt;Void&gt;</code> which completes when the mail is sent. It does not block the caller thread.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The API is similar to the <em>imperative</em> one except that the <code>send</code> method returns a <code>Uni&lt;Void&gt;</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now, in your terminal, run</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; curl http://localhost:8080/mail/reactive</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should see in the application log something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">INFO  [quarkus-mailer] (vert.x-eventloop-thread-11) Sending email Ahoy from Quarkus from null to [quarkus@quarkus.io], text body:
A simple email sent from a Quarkus application using the reactive API.
html body:
&lt;empty&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-the-mailer"><a class="anchor" href="#configuring-the-mailer"></a>Configuring the mailer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It&#8217;s time to configure the mailer to not simulate the sending of the emails.
The Quarkus mailer is using SMTP, so make sure you have access to an SMTP server.</p>
</div>
<div class="paragraph">
<p>In the <code>src/main/resources/application.properties</code> file, you need to configure the host, port, username, password as well as the other configuration aspect.
Note that the password can also be configured using system properties and environment variables.
See the <a href="config-reference">configuration reference guide</a> for details.</p>
</div>
<div class="paragraph">
<p>Configuration of popular mail services is covered in <a href="mailer-reference#popular">the reference guide</a>.</p>
</div>
<div class="paragraph">
<p>Once you have configured the mailer, if you call the HTTP endpoint as shown above, you will send emails.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="conclusion"><a class="anchor" href="#conclusion"></a>Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This guide has shown how to send emails from your Quarkus application.
The <a href="mailer-reference">mailer reference guide</a> provides more details about the mailer usage and configuration such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="mailer-reference#attachments">how to add attachments</a></p>
</li>
<li>
<p><a href="mailer-reference#html">how to format the email as HTML and use inline attachments</a></p>
</li>
<li>
<p><a href="mailer-reference#templates">how to use Qute templates</a></p>
</li>
<li>
<p><a href="mailer-reference#testing">how to test applications sending emails</a></p>
</li>
<li>
<p><a href="mailer-reference#gmail-specific-configuration">how to configure the mailer to send emails with GMAIL</a></p>
</li>
</ul>
</div>
</div>
</div>