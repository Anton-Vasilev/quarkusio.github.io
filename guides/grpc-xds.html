<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This page explains how to enable xDS gRPC usage in your Quarkus application.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This Quarkus xDS gRPC integration currently doesn&#8217;t support building native executables due to the issues
with shaded grpc-netty library while running native IT tests.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-your-project"><a class="anchor" href="#configuring-your-project"></a>Configuring your project</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Add the Quarkus gRPC xDS extension to your build file:</p>
</div>
<div class="listingblock primary asciidoc-tabs-target-sync-cli asciidoc-tabs-target-sync-maven">
<div class="title">pom.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-grpc-xds&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-target-sync-gradle">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-gradle hljs" data-lang="gradle">implementation("io.quarkus:quarkus-grpc-xds")</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This transitively adds <code>io.quarkus:quarkus-grpc</code> extension dependency.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="server-configuration"><a class="anchor" href="#server-configuration"></a>Server configuration</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="server-configuration-example"><a class="anchor" href="#server-configuration-example"></a>Server configuration example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To enable server xDS, use the following configuration.</p>
</div>
<div class="paragraph">
<p>xDS must be explicitly enabled on the server, then verify you use it on the right xDS server port (default is 9000).
If you want to use <code>XdsServerCredentials</code> set <code>xds.secure</code> to <code>true</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.grpc.server.xds.enabled=true
#quarkus.grpc.server.xds.secure=true
quarkus.grpc.server.port=30051</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When xDS is configured, <code>plain-text</code> is automatically disabled.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="client-configuration"><a class="anchor" href="#client-configuration"></a>Client configuration</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When xDS target property is used, name resolver, host, and port are not used
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="client-configuration-example"><a class="anchor" href="#client-configuration-example"></a>Client configuration example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To enable client xDS, use the following configuration.</p>
</div>
<div class="paragraph">
<p>You can either explicitly enable xDS or you use <code>xds</code> name resolver,
and make sure you point it to the right xDS server port (default is 9000).
If you want to use <code>XdsChannelCredentials</code> set <code>xds.secure</code> to <code>true</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">#quarkus.grpc.clients.&lt;client-name&gt;.xds.enabled=true
#quarkus.grpc.clients.&lt;client-name&gt;.xds.secure=true
quarkus.grpc.clients.&lt;client-name&gt;.name-resolver=xds
quarkus.grpc.clients.&lt;client-name&gt;.port=30051</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When xDS is configured, <code>plain-text</code> is automatically disabled.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="kubernetes-configuration-example"><a class="anchor" href="#kubernetes-configuration-example"></a>Kubernetes configuration example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Below is an example of (required) additional configuration when using xDS gRPC with the Istio Service Mesh in Kubernetes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.kubernetes.ports.grpc.container-port=30051
quarkus.kubernetes.annotations."inject.istio.io/templates"=grpc-agent
quarkus.kubernetes.annotations."proxy.istio.io/config"={"holdApplicationUntilProxyStarts": true}</code></pre>
</div>
</div>
</div>
</div>